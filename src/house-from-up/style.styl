*
*:after
  box-sizing border-box
  transform-style preserve-3d

:root
  --perspective 0
  --rotate-x -15
  --rotate-y -40
  --house-height 12
  --scale 1.5
  // colors
  --brick hsl(15, 60%, 40%)
  --pitch-top hsl(20, 50%, 30%)
  --pitch-under hsl(180, 60%, 50%)
  --pitch-back hsl(180, 60%, 30%)
  --yellow-one hsl(65, 80%, 50%)
  --yellow-two hsl(65, 80%, 40%)
  --yellow-three hsl(65, 80%, 30%)
  --pink-one hsl(10, 80%, 75%)
  --pink-two hsl(10, 80%, 65%)
  --pink-three hsl(10, 80%, 55%)
  --orange-one hsl(20, 80%, 70%)
  --orange-two hsl(20, 80%, 60%)
  --orange-three hsl(20, 80%, 50%)
  --blue-one hsl(190, 80%, 50%)
  --blue-two hsl(190, 80%, 40%)
  --blue-three hsl(190, 80%, 30%)
  --windowsill hsl(0, 0%, 90%)
  --internal hsl(180, 80%, 8%)
  --panel-shade hsla(0, 0%, 0%, 0.25)

body
  min-height 100vh
  // overflow hidden
  background hsl(0, 0%, 90%)

.scene
  perspective calc(var(--perspective, 800) * 1px)
  transform-style preserve-3d
  height 100vh
  width 100vw
  display flex
  align-items center
  justify-content center
  transform scale(var(--scale))

.plane
  height calc(var(--plane-height, 30) * 1vmin)
  width calc(var(--plane-width, 25) * 1vmin)
  transform-style preserve-3d
  transform rotateX(calc(var(--rotate-x, -24) * 1deg)) rotateY(calc(var(--rotate-y, -24) * 1deg)) rotateX(90deg) translate3d(0, 0, 0)


// This is what makes the CSS variable powered cuboid
.cuboid
  --width var(--cuboid-width, 15)
  --height var(--cuboid-height, 10)
  --depth var(--cuboid-depth, 4)
  height calc(var(--depth) * 1vmin)
  width calc(var(--width) * 1vmin)
  position absolute
  transform translate3d(calc(var(--x, 0) * 1vmin), calc(var(--y, 0) * 1vmin), calc(var(--z, 0) * 1vmin)) rotateX(calc(var(--rotate-cuboid-x, 0) * 1deg)) rotateY(calc(var(--rotate-cuboid-y, 0) * 1deg)) rotateZ(calc(var(--rotate-cuboid-z, 0) * 1deg))
  transform-style preserve-3d

  &__side
    transform-style preserve-3d

  & > div:nth-of-type(1)
    height calc(var(--height) * 1vmin)
    width 100%
    transform-origin 50% 50%
    transform rotateX(-90deg)
    position absolute
    top 50%
    left 50%
    transform translate(-50%, -50%) rotateX(-90deg) translate3d(0, 0, calc((var(--depth) / 2) * 1vmin))

  & > div:nth-of-type(2)
    height calc(var(--height) * 1vmin)
    width 100%
    transform-origin 50% 50%
    transform translate(-50%, -50%) rotateX(-90deg) rotateY(180deg) translate3d(0, 0, calc((var(--depth) / 2) * 1vmin))
    position absolute
    top 50%
    left 50%

  & > div:nth-of-type(3)
    height calc(var(--height) * 1vmin)
    width calc(var(--depth) * 1vmin)
    transform translate(-50%, -50%) rotateX(-90deg) rotateY(90deg) translate3d(0, 0, calc((var(--width) / 2) * 1vmin))
    position absolute
    top 50%
    left 50%

  & > div:nth-of-type(4)
    height calc(var(--height) * 1vmin)
    width calc(var(--depth) * 1vmin)
    transform translate(-50%, -50%) rotateX(-90deg) rotateY(-90deg) translate3d(0, 0, calc((var(--width) / 2) * 1vmin))
    position absolute
    top 50%
    left 50%

  & > div:nth-of-type(5)
    height calc(var(--depth) * 1vmin)
    width calc(var(--width) * 1vmin)
    transform translate(-50%, -50%) translate3d(0, 0, calc((var(--height) / 2) * 1vmin))
    position absolute
    top 50%
    left 50%

  & > div:nth-of-type(6)
    height calc(var(--depth) * 1vmin)
    width calc(var(--width) * 1vmin)
    transform translate(-50%, -50%) translate3d(0, 0, calc((var(--height) / 2) * -1vmin)) rotateX(180deg)
    position absolute
    top 50%
    left 50%

// 30 x 25
.house

  &__mini-pitch
    --width 10
    --height 4
    --depth 6
    --z 19
    --y 20
    --x 9

    div
      --bg var(--orange-one)
      background linear-gradient(transparent 90%, var(--panel-shade)) 0 0 / 100% 1vmin, var(--bg)

      &:nth-of-type(1)
        --bg var(--orange-three)

      &:nth-of-type(3):after
        content ''
        height 90%
        width 50%
        border 0.25vmin solid var(--windowsill)
        background linear-gradient(var(--yellow-three), var(--yellow-three)) 0.25vmin 83%/82% 36% no-repeat,
                  linear-gradient(var(--yellow-three), var(--yellow-three)) 0.25vmin 0.25vmin/82% 40% no-repeat,
                  var(--pink-one)
        position absolute
        bottom 40%
        left 50%
        transform translate3d(-50%, 0, 1px)

  &__mini-pitch-top
    --width 10
    --height 4
    --depth 6
    --z 23
    --y 20
    --x 9

    div
      --bg var(--orange-one)
      background linear-gradient(transparent 90%, var(--panel-shade)) 0 0 / 100% 1vmin, var(--bg)

    div:nth-of-type(1)
    div:nth-of-type(2)
    div:nth-of-type(5)
      background transparent

    div:nth-of-type(3)
      $clip = polygon(0 100%, 50% 0, 100% 100%)
      -webkit-clip-path $clip
      clip-path $clip

  &__side
    --width 8
    --x 5
    --y -4
    --depth 4
    --height 10
    --z 7

    div
      --bg var(--pink-one)
      background linear-gradient(transparent 90%, var(--panel-shade)) 0 0 / 100% 1vmin, var(--bg)

      &:nth-of-type(1)
      &:nth-of-type(5)
      &:nth-of-type(6)
        background var(--transparent)

      &:nth-of-type(3)
        --bg var(--pink-three)

      &:nth-of-type(2):after
        content ''
        position absolute
        top 10%
        left 50%
        width 50%
        height 60%
        transform translate3d(-50%, 0, 1px)
        border 0.25vmin solid var(--windowsill)
        background linear-gradient(var(--internal), var(--internal)) 0.25vmin 83%/82% 36% no-repeat,
                  linear-gradient(var(--internal), var(--internal)) 0.25vmin 0.25vmin/82% 40% no-repeat,
                  var(--pink-one)


  &__side-pitch-body
    --width 8
    --x 5
    --y -4
    --depth 10
    --height 8
    --z 17

    div
      background var(--pink-one)
      filter brightness(var(--b, 1))

      &:nth-of-type(3)
        --b 0.5

      &:nth-of-type(2)
        --b 0.95

      &:nth-of-type(1)
      &:nth-of-type(5)
      &:nth-of-type(6)
      &:nth-of-type(1):after
      &:nth-of-type(5):after
      &:nth-of-type(6):after
        display none

      &:after
        content ''
        background url('https://assets.codepen.io/605876/house-roof-tile--pink.png')
        position absolute
        height 100%
        width 100%
        left 0
        top 0

  &__side-pitch-pitch
    --width 8
    --x 5
    --y -4
    --depth 10
    --height 10
    --z 25

    div:nth-of-type(2)
      $clip = polygon(0 100%, 50% 0, 100% 100%)
      -webkit-clip-path $clip
      clip-path $clip
      background var(--pink-one)
      filter brightness(0.95)

      &:before
        content ''
        background url('https://assets.codepen.io/605876/house-roof-tile--pink.png')
        position absolute
        height 100%
        width 100%
        left 0
        top 0

    div:nth-of-type(1)
    div:nth-of-type(3)
    div:nth-of-type(4)
    div:nth-of-type(5)
    div:nth-of-type(6)
      background transparent

  &__side-trim
    --width 10
    --x 4
    --depth 5
    --y -5
    --height 1.5
    --z 12.25

    div
      background red

  &__main
    --width 14
    --depth 30
    --height var(--house-height)
    --z calc((var(--house-height) / 2) + 2)

  &__top
    --width 20
    --depth 30
    --height 2
    --z calc(var(--house-height) + 2)

  &__front
    --width 22
    --height calc(var(--house-height) + 1)
    --depth 15
    --z calc((var(--house-height) / 2) + 2.5)
    --x -2

  &__front-slant
    --width 5
    --depth 16
    --height 4
    --z 15
    --x 20
    --y -0.5

    div
      &:nth-of-type(1):after
        --clip polygon(50% 0, 100% 100%, 0 100%, 0 0)
      &:nth-of-type(2):after
        --clip polygon(100% 0%, 100% 100%, 0 100%, 50% 0)
      &:nth-of-type(1):after
      &:nth-of-type(2):after
        content ''
        position absolute
        top 0
        left 0
        width 100%
        height 100%
        transform-origin 50% 100%
        transform rotateX(13deg)
        background orange
        -webkit-clip-path var(--clip)
        clip-path var(--clip)


      &:nth-of-type(3):after
        content ''
        background blue
        position absolute
        height 100%
        width 100%
        top 0
        left 0
        transform-origin 50% 100%
        transform rotateX(30deg)
        $clip = polygon(0 100%, 5% 0, 95% 0, 100% 100%)
        -webkit-clip-path $clip
        clip-path $clip

  &__pitch-main-body
    --width 25
    --depth 15
    --height 8
    --z 16
    --x -2

    div
      background grey

  &__pitch-main-pitch
    --width 25
    --depth 15
    --height 15
    --z 27.5
    --x -2

    div
      background orange

      &:nth-of-type(1)
      &:nth-of-type(2)
      &:nth-of-type(5)
      &:nth-of-type(6)
        background transparent

      &:nth-of-type(3)
      &:nth-of-type(4)
        $clip = polygon(0 100%, 50% 0, 100% 100%)
        -webkit-clip-path $clip
        clip-path $clip

  &__pitch-left
    --width 20
    --depth 20
    --height var(--house-height)
    --z calc(var(--house-height) + (var(--house-height) / 2) + 3)
    --y 10

    div
      background transparent

      &:nth-of-type(1)
      &:nth-of-type(2)
        $clip = polygon(0 100%, 50% 0, 100% 100%)
        -webkit-clip-path $clip
        clip-path $clip

.pitch
  position absolute

  &--side
    height 12vmin
    width 8vmin
    left 5vmin
    top -4vmin
    transform translate3d(0, 0, 30vmin)

    .cuboid
      --depth 10
      --height 1
      --width 12.5
      --y -1

    &-front
      transform-origin 0% 0%
      transform translate3d(50%, 0, 30vmin) rotateY(68deg) translate(-0.25vmin, 0)

    &-back
      transform-origin 100% 0%
      transform translate3d(-50%, 0, 30vmin) rotateY(-68deg) translate(0.25vmin, 0)

      .cuboid
        right 0

  &--main
    height 15vmin
    width 27vmin
    left -3vmin

    .cuboid
      --depth 23
      --width 27
      --height 2
      --z 0.25

    &-left
      transform-origin 50% 0
      transform translate3d(0, 50%, 35vmin) rotateX(-67deg) translate(0, -0.5vmin)

      .cuboid
        top 0

    &-right
      transform-origin 50% 100%
      transform translate3d(0, -50%, 35vmin) rotateX(67deg) translate(0, 0.5vmin)

      .cuboid
        bottom 0

  &--mini
    height 6vmin
    width 10vmin
    top 20vmin
    transform translate3d(0, 0, 25vmin)
    left 9vmin

    .cuboid
      --height 0.5
      --width 10
      --depth 6

    &-left
      transform-origin 50% 0
      transform translate3d(0.5vmin, 50%, 25vmin) rotateX(-54deg) translate(0, -0.2vmin)
    &-right
      transform-origin 50% 100%
      transform translate3d(0.5vmin, -50%, 25vmin) rotateX(54deg) translate(0, 0.2vmin)

  &--left
    height 20vmin
    width 17vmin
    position absolute
    transform translate3d(0, 0, 27vmin)
    top 11vmin

    &-front
      transform-origin 0% 50%
      transform translate3d(10vmin, 0, 27vmin) rotateY(50deg) translate(-1vmin, 0)
    &-back
      transform-origin 100% 50%
      transform translate3d(-7vmin, 0, 27vmin) rotateY(-50deg) translate(1vmin, 0)

    .cuboid
      --width 17
      --height 1
      --depth 20
      --y 0
      --z 0.5

      div
        background blue

.bay-window
  --height 10
  --width 5
  --depth 15
  --x 20
  --z 7

  div
    background hsla(180, 50%, 50%, 0.5)

    &:nth-of-type(3)
      $clip = inset(0 25% 0 25%)
      -webkit-clip-path $clip
      clip-path $clip

    &:nth-of-type(1)
    &:nth-of-type(2)
    &:nth-of-type(5)
    &:nth-of-type(6)
      background-color transparent

    &:nth-of-type(1):after
      content ''
      position absolute
      left 0
      top 0
      transform-origin 0 50%
      width 126%
      height 100%
      background hsla(280, 50%, 50%, 0.5)
      transform rotateY(37deg)
    &:nth-of-type(2):after
      content ''
      position absolute
      right 0
      top 0
      transform-origin 100% 50%
      width 126%
      height 100%
      background hsla(280, 50%, 50%, 0.5)
      transform rotateY(-37deg)


.bay-trim
  --height 1.5
  --width 6
  --depth 17
  --y -1
  --x 20
  --z calc((var(--house-height) + 0.25))

  div
    background red



.base
  &--main
    --height 2
    --width 20
    --depth 30
    --z 1

  div
    background orange

  &--back
    --depth 15
    --width 2
    --height 2
    --x -2
    --z 1

  &--front
    --x 20
    --z 1
    --height 2
    --width 5
    --depth 15

    div
      &:nth-of-type(3)
        $clip = inset(0 25% 0 25%)
        -webkit-clip-path $clip
        clip-path $clip

      &:nth-of-type(1)
      &:nth-of-type(2)
      &:nth-of-type(5)
      &:nth-of-type(6)
        background-color transparent

      &:nth-of-type(1):after
        content ''
        position absolute
        left 0
        top 0
        transform-origin 0 50%
        width 126%
        height 100%
        background hsla(0, 50%, 50%, 0.5)
        transform rotateY(37deg)
      &:nth-of-type(2):after
        content ''
        position absolute
        right 0
        top 0
        transform-origin 100% 50%
        width 126%
        height 100%
        background hsla(0, 50%, 50%, 0.5)
        transform rotateY(-37deg)

  &--side
    --z 1
    --height 2
    --width 8
    --depth 4
    --y -4
    --x 5

.chimney
  --width 6
  --height 16
  --depth 4
  --z 32
  --x 7
  --y 13

  div
    background var(--brick)

    &:nth-of-type(1)
      filter brightness(0.5)
    &:nth-of-type(3)
      filter brightness(0.75)

    &:nth-of-type(5)
      border 1vmin solid var(--pitch-top)
      background #111

      &:after
        display none
    &:after
      content ''
      position absolute
      height 100%
      width 100%
      top 0
      left 0
      background url('https://assets.codepen.io/605876/bricks.png')

.chimney__skirt
  --width 7
  --height 1
  --depth 5
  --z 37
  --x 6.5
  --y 12.5

  div
    background var(--brick)
    &:after
      content ''
      position absolute
      height 100%
      width 100%
      top 0
      left 0
      background url('https://assets.codepen.io/605876/bricks.png')
      filter brightness(0.5)

.post
  &--left
    --depth 1
    --width 1
    --height 12
    --y 29
    --x 19
    --z 8
  &--right
    --depth 1
    --width 1
    --height 12
    --y 23
    --x 19
    --z 8
  &--back
    --depth 1
    --width 1
    --height 12
    --y 29
    --x 14
    --z 8
  &--front-top
    --depth 15
    --width 1
    --height 1
    --y 15
    --x 19
    --z 13
  &--front-side
    --depth 1
    --width 6
    --height 1
    --y 29
    --x 14
    --z 13
  &--top-support
    --depth 15
    --width 0.5
    --height 0.5
    --y 15
    --x 19.5
    --z 11.5
  &--top-side-support
    --depth 0.5
    --width 5
    --height 0.5
    --y 29.5
    --x 15
    --z 11.5
  &--bottom-side-support
    --depth 0.5
    --width 5
    --height 0.5
    --y 29.5
    --x 15
    --z 6
  &--bottom-support
    --depth 7
    --width 0.5
    --height 0.5
    --y 23
    --x 19.5
    --z 6
  &--stair
    --depth 1
    --width 1
    --height 4
    --x 24
    --y 23
    --z 2
  &--handrail
    --depth 1
    --height 1
    --width 6
    --rotate-cuboid-y 30
    --x 19
    --y 23
    --z 5

  div
    background blue

.steps
  background hsla(290, 50%, 50%, 0.5)
  position absolute

  &--front
    top 15vmin
    left 20vmin
    width 5vmin
    height 8vmin

    & > div:nth-of-type(1)
      --height 1.5
      --width calc(5 / 3)
      --depth 8
      --z 0.75
    & > div:nth-of-type(2)
      --height 1
      --width calc(5 / 3)
      --depth 8
      --z 0.5
      --x calc(5 / 3)
    & > div:nth-of-type(3)
      --height 0.5
      --width calc(5 / 3)
      --depth 8
      --z 0.25
      --x calc((5 / 3) * 2)



    & > div div
        background-color red


  &--back
    top 15vmin
    left -2vmin
    height 8vmin
    width 2vmin

    & > div
      --height 1
      --width 2
      --depth 8
      --z 0.5

      div
        background-color red

.rafter
  --z 36
  --x -3
  --y 6.5
  --width 27
  --height 1
  --depth 2

  div
    background var(--pitch-top)

.fence
  position absolute
  &--front-top
    background linear-gradient(transparent 50%, blue 50%) 0 0 / 100% 1vmin
    width 1.5vmin
    height 15vmin
    top 15vmin
    left 19vmin
    transform translate3d(0, 0, 12.5vmin) rotateY(90deg)
  &--side-top
    background linear-gradient(transparent 50%, blue 50%) 0 0 / 100% 1vmin
    width 1.5vmin
    height 6vmin
    top 27vmin
    left 19vmin
    transform translate3d(0, 0, 12.5vmin) rotateY(90deg) rotateX(90deg) translate(0, -50%)
  &--side-bottom
    background linear-gradient(90deg, transparent 50%, blue 50%) 0 0 / 1vmin 100%
    width 5vmin
    height 4vmin
    top 25.5vmin
    left 14.5vmin
    transform-origin 50% 100%
    transform translate3d(0, 0, 2vmin) rotateX(-90deg)
  &--front-bottom
    background linear-gradient(transparent 50%, blue 50%) 0 0 / 100% 1vmin
    width 4vmin
    height 6vmin
    top 23.5vmin
    left 19.5vmin
    transform-origin 0% 50%
    transform translate3d(0, 0, 2vmin) rotateY(-90deg)
  &--handrail
    height 8vmin
    width 5vmin
    top 23.5vmin
    left 20vmin
    background linear-gradient(90deg, transparent 50%, blue 50%) 0 0 / 1vmin 100%
    transform-origin 50% 0
    transform rotateX(90deg)
    $clip = polygon(0 0, 0 80%, 100% 40%, 100% 0%)
    -webkit-clip-path $clip
    clip-path $clip

.pipe
  div
    background-color pink

  &--vertical
    --depth 0.5
    --width 0.5
    --height 18
    --z 11
    --x -2.5
    --y 13
  &--horizontal
    --depth 12
    --width 0.5
    --height 0.5
    --z 16
    --x -2.5
    --y 2
    --rotate-cuboid-x -15

.pitch .cuboid
  div
    background var(--pitch-under)
    overflow hidden

    &:nth-of-type(1)
    &:nth-of-type(2)
      background var(--pitch-top)

    &:nth-of-type(6)
      background var(--pitch-back)

    &:nth-of-type(5)
      filter brightness(var(--b, 1))

    &:nth-of-type(5):after
      content ''
      position absolute
      top 50%
      left 50%
      width 200%
      height 200%
      transform translate(-50%, -50%) rotate(calc(var(--r, 0) * 1deg))
      background url('https://assets.codepen.io/605876/house-roof-tile.png')

.pitch--left .cuboid div
.pitch--side .cuboid div
  &:nth-of-type(1)
  &:nth-of-type(2)
    background var(--pitch-under)
  &:nth-of-type(3)
  &:nth-of-type(4)
    background var(--pitch-top)


.pitch--mini-left
  --b 0.5
.pitch--mini-right
  --r 180
.pitch--left-front
  --b 0.75
  --r -90
.pitch--left-back
  --r 90
.pitch--main-left
  --b 0.5
.pitch--main-right
  --r 180
  --b 0.75
.pitch--side-front
  --b 0.5
  --r -90
.pitch--side-back
  --r 90

.window
  position absolute
  background var(--internal)

  &--side
    width 3vmin
    height 6vmin
    left 7.5vmin
    top -4.1vmin
    transform-origin 50% 0
    transform rotateX(90deg) translate(0, 18vmin)